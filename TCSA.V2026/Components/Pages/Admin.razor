@page "/admin"

@using Microsoft.AspNetCore.Authorization
@using TCSA.V2026.Data.DTOs
@using TCSA.V2026.Data.Models
@using TCSA.V2026.Services

@attribute [Authorize]

<PageTitle>Auth</PageTitle>

@rendermode InteractiveServer

<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudDataGrid Items="@adminEvents" RowStyle="GetRowStyle">
    <Columns>
        <PropertyColumn Property="x => x.Date" Title="DateTime" />
        <PropertyColumn Property="x => x.ActivityType" Title="Activity" CellStyleFunc="@_cellStyleFunc" />
    </Columns>
</MudDataGrid>

@code {
    [Inject] protected IAdminService UserService { get; set; }

    private List<AdminEventDisplay>? adminEvents { get; set; } = new();

    protected override async Task OnInitializedAsync() {
        adminEvents = await UserService.GetAdminEvents();   
        Console.WriteLine("lala");
    }

    private Func<AdminEventDisplay, string> _cellStyleFunc => x =>
    {
        string style = "";

        if (x.ActivityType == ActivityType.ArticleRead)
            style += "background-color:green";

        return style;
    };
}

